Sub stockmarket()Dim i, volume, first_volume, last_row, yearly_change As DoubleDim no_tickers As Doubleno_tickers = 2last_row = Cells(Rows.Count, 1).End(xlUp).RowFor i = 2 To last_row'accumulate volume if row belongs to same ticker as next row    If Cells(i, 1).Value = Cells(i + 1, 1).Value Then        volume = Cells(i, 7).Value        first_volume = first_volume + volume    End If'if it is the first row of the ticker then find the opening value    If Cells(i, 1).Value <> Cells(i - 1, 1).Value Then            open_value = Cells(i, 3).Value            'assign the ticker to a cell            Cells(no_tickers, 11).Value = Cells(i, 1).Value    End If'find the last row of the ticker in order to find closing value    If Cells(i, 1).Value <> Cells(i + 1, 1).Value Then            close_value = Cells(i, 6).Value            'substract the opening from the closing value            Cells(no_tickers, 12).Value = (close_value) - open_value            yearly_change = close_value - open_value            'give conditioning formating            If Cells(no_tickers, 12).Value >= 0 Then                Cells(no_tickers, 12).Interior.ColorIndex = 4            Else                Cells(no_tickers, 12).Interior.ColorIndex = 3            End If            'calculate percentage change            Cells(no_tickers, 13).Value = (yearly_change / open_value)            'add percentage format            Cells(no_tickers, 13).Value = FormatPercent(Cells(no_tickers, 13), 1)            'add the last volume to the total volume count            volume = Cells(i, 7).Value            first_volume = first_volume + volume            Cells(no_tickers, 14) = first_volume            first_volume = 0            'increase ticker count            no_tickers = no_tickers + 1    End IfNext iEnd Sub